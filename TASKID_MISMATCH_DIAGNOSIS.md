# ğŸ” TaskId ä¸åŒ¹é…é—®é¢˜è¯Šæ–­

## ğŸ”´ é—®é¢˜ç—‡çŠ¶

**å·¥ä½œæµ3æå–çš„taskId**ï¼š

```
task_1761796411352_hus1tzkaj  âŒ æ—§çš„/é”™è¯¯çš„
```

**å·¥ä½œæµ1åˆ›å»ºçš„taskId**ï¼š

```
task_1761797568494_qkjctfiwa  âœ… æ–°çš„/æ­£ç¡®çš„
```

**ç»“æœ**ï¼šå·¥ä½œæµ3æŸ¥è¯¢æ•°æ®åº“æ—¶ä½¿ç”¨é”™è¯¯çš„taskIdï¼Œå¯¼è‡´æŸ¥ä¸åˆ°æ•°æ®ï¼Œå½¢æˆæ­»å¾ªç¯ã€‚

---

## ğŸ¯ è¯Šæ–­æ­¥éª¤

### æ­¥éª¤1: é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
# é‡æ–°å¯åŠ¨
npm run dev
```

**åŸå› **ï¼šç¡®ä¿ä½¿ç”¨æœ€æ–°çš„å‰ç«¯ä»£ç ï¼ˆåŒ…å«æ–°çš„è°ƒè¯•æ—¥å¿—ï¼‰

---

### æ­¥éª¤2: æäº¤æ–°çš„æµ‹è¯•è¯·æ±‚

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Console** æ ‡ç­¾
3. æ¸…ç©ºæ§åˆ¶å°æ—¥å¿—
4. åœ¨å‰ç«¯è¾“å…¥æµ‹è¯•ä¸»é¢˜ï¼ˆä¾‹å¦‚ï¼š"æµ‹è¯•taskIdè¿½è¸ª"ï¼‰
5. ç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®

---

### æ­¥éª¤3: æ£€æŸ¥å‰ç«¯æ—¥å¿—

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­ï¼Œåº”è¯¥çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ï¼š

```
ğŸ“¤ Submitting async task...
âœ… Parsed submit data: {taskId: "task_XXX...", status: "pending"}
âœ… Task created: task_XXX...
ğŸ” TaskId type: string
ğŸ” TaskId length: 29
ğŸ“ Status URL from response: https://...
ğŸ” Constructed statusUrl: https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_XXX...
ğŸ” TaskId in URL: task_XXX...
```

**å…³é”®æ£€æŸ¥ç‚¹**ï¼š

- âœ… `Task created` è¿™è¡Œæ˜¾ç¤ºçš„taskIdæ˜¯ä»€ä¹ˆï¼Ÿ
- âœ… `Constructed statusUrl` æ˜¯å¦åŒ…å«æ­£ç¡®çš„taskIdï¼Ÿ

**è¯·å¤åˆ¶è¿™äº›æ—¥å¿—å¹¶å‘Šè¯‰æˆ‘taskIdçš„å€¼ï¼**

---

### æ­¥éª¤4: ç­‰å¾…è½®è¯¢å¼€å§‹

2.5åˆ†é’Ÿåï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºï¼š

```
âœ… Initial delay complete, starting status checks...
ğŸ”„ Polling attempt 1/80...
ğŸ” Polling URL: https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_XXX...
ğŸ” TaskId still: task_XXX...
```

**å…³é”®æ£€æŸ¥ç‚¹**ï¼š

- âœ… `Polling URL` æ˜¯å¦åŒ…å«æ­£ç¡®çš„taskIdï¼Ÿ
- âœ… `TaskId still` æ˜¯å¦å’Œä¹‹å‰åˆ›å»ºçš„ä¸€è‡´ï¼Ÿ

---

### æ­¥éª¤5: æ£€æŸ¥Networkè¯·æ±‚

åœ¨å¼€å‘è€…å·¥å…·ä¸­ï¼š

1. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾
2. æ‰¾åˆ° `task-status` çš„GETè¯·æ±‚
3. ç‚¹å‡»è¯¥è¯·æ±‚
4. æŸ¥çœ‹ **Headers** æ ‡ç­¾ä¸­çš„ **Request URL**

**è¯·å¤åˆ¶å®Œæ•´çš„Request URLï¼**

ç¤ºä¾‹ï¼š

```
https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_1761797568494_qkjctfiwa
                                                                    â†‘
                                                            è¿™ä¸ªåº”è¯¥æ˜¯æ–°åˆ›å»ºçš„taskId
```

---

### æ­¥éª¤6: æ£€æŸ¥n8nå·¥ä½œæµ3æ‰§è¡Œæ—¥å¿—

1. æ‰“å¼€n8nç®¡ç†ç•Œé¢
2. ç‚¹å‡» **Executions**
3. æ‰¾åˆ°æœ€æ–°çš„å·¥ä½œæµ3æ‰§è¡Œè®°å½•ï¼ˆåç§°ï¼šRedNote Subject - Query Statusï¼‰
4. ç‚¹å‡» **Extract Task ID** èŠ‚ç‚¹
5. æŸ¥çœ‹ **Console Output**

**å¦‚æœä½ ä½¿ç”¨äº†è°ƒè¯•ä»£ç **ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
================================================================================
ğŸ” DEBUG: Extract Task ID - START
================================================================================
ğŸ“Š KEY FIELDS:
  webhookUrl: https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_XXX...
  path: /task-status/task_XXX...

ğŸ¯ EXTRACTION RESULT:
  taskId: task_XXX...
  Method: webhookUrl
```

**è¯·å¤åˆ¶è¿™äº›æ—¥å¿—ï¼Œç‰¹åˆ«æ˜¯ taskId çš„å€¼ï¼**

---

### æ­¥éª¤7: å¯¹æ¯”æ‰€æœ‰taskId

ç°åœ¨å¯¹æ¯”ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹çš„taskIdï¼š

| ä½ç½®                          | TaskId    | æ˜¯å¦ä¸€è‡´ï¼Ÿ |
| ----------------------------- | --------- | ---------- |
| **å·¥ä½œæµ1åˆ›å»º**               | task\_??? | -          |
| **å‰ç«¯Console: Task created** | task\_??? | âœ…/âŒ      |
| **å‰ç«¯Console: Polling URL**  | task\_??? | âœ…/âŒ      |
| **Network: Request URL**      | task\_??? | âœ…/âŒ      |
| **å·¥ä½œæµ3æå–**               | task\_??? | âœ…/âŒ      |

**å¦‚æœå…¨éƒ¨ä¸€è‡´** â†’ é—®é¢˜å‡ºåœ¨æ•°æ®åº“æŸ¥è¯¢ä¸Š
**å¦‚æœä¸ä¸€è‡´** â†’ æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸ä¸€è‡´çš„åœ°æ–¹ï¼Œé—®é¢˜å°±åœ¨é‚£é‡Œ

---

## ğŸ¯ å¯èƒ½çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜A: å·¥ä½œæµ1è¿”å›äº†é”™è¯¯çš„taskId

**ç—‡çŠ¶**ï¼šå‰ç«¯`Task created`æ˜¾ç¤ºçš„taskIdå’Œå·¥ä½œæµ1å®é™…åˆ›å»ºçš„ä¸åŒ

**æ£€æŸ¥æ–¹æ³•**ï¼š

1. åœ¨n8nä¸­æŸ¥çœ‹å·¥ä½œæµ1çš„æ‰§è¡Œå†å²
2. æ‰¾åˆ°å¯¹åº”æ—¶é—´çš„æ‰§è¡Œè®°å½•
3. æŸ¥çœ‹"Respond to Webhook"èŠ‚ç‚¹çš„è¾“å‡º

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥å·¥ä½œæµ1çš„taskIdç”Ÿæˆé€»è¾‘

---

### é—®é¢˜B: å‰ç«¯ç¼“å­˜äº†æ—§çš„taskId

**ç—‡çŠ¶**ï¼š

- å·¥ä½œæµ1è¿”å›çš„æ˜¯æ–°taskId
- ä½†å‰ç«¯æ—¥å¿—æ˜¾ç¤ºçš„æ˜¯æ—§taskId

**å¯èƒ½åŸå› **ï¼š

- æµè§ˆå™¨ç¼“å­˜
- ReactçŠ¶æ€ç®¡ç†é—®é¢˜
- é—­åŒ…æ•è·äº†æ—§å€¼

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡¬åˆ·æ–°æµè§ˆå™¨ï¼ˆCtrl+F5ï¼‰
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
3. é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨

---

### é—®é¢˜C: å‰ç«¯å‘é€äº†é”™è¯¯çš„URL

**ç—‡çŠ¶**ï¼š

- å‰ç«¯Consoleæ˜¾ç¤ºæ­£ç¡®çš„taskId
- ä½†Networkä¸­çš„Request URLåŒ…å«é”™è¯¯çš„taskId

**å¯èƒ½åŸå› **ï¼š

- statusUrlå˜é‡è¢«è¦†ç›–
- æœ‰å…¶ä»–ä»£ç åœ¨ä¿®æ”¹URL

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥å‰ç«¯ä»£ç ä¸­æ˜¯å¦æœ‰å…¶ä»–åœ°æ–¹ä¿®æ”¹äº†statusUrl

---

### é—®é¢˜D: å·¥ä½œæµ3æå–é€»è¾‘é”™è¯¯

**ç—‡çŠ¶**ï¼š

- Networkä¸­çš„URLåŒ…å«æ­£ç¡®çš„taskId
- ä½†å·¥ä½œæµ3æå–åˆ°äº†é”™è¯¯çš„taskId

**å¯èƒ½åŸå› **ï¼š

- Extract Task IDèŠ‚ç‚¹çš„é€»è¾‘æœ‰é—®é¢˜
- n8nç¼“å­˜äº†æ—§çš„æ‰§è¡Œç»“æœ

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ä½¿ç”¨è°ƒè¯•ä»£ç æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
2. æ£€æŸ¥webhookUrlå­—æ®µçš„å€¼
3. é‡å¯n8næœåŠ¡ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰

---

## ğŸ§ª å¿«é€ŸéªŒè¯æ–¹æ³•

### æ–¹æ³•1: æ‰‹åŠ¨æµ‹è¯•URL

ä»å·¥ä½œæµ1è·å–æ­£ç¡®çš„taskIdï¼Œä¾‹å¦‚ï¼š

```
task_1761797568494_qkjctfiwa
```

åœ¨æµè§ˆå™¨åœ°å€æ ç›´æ¥è®¿é—®ï¼š

```
https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_1761797568494_qkjctfiwa
```

æŸ¥çœ‹ï¼š

1. æ˜¯å¦è¿”å›äº†æ­£ç¡®çš„æ•°æ®ï¼Ÿ
2. å·¥ä½œæµ3çš„Extract Task IDæå–åˆ°äº†ä»€ä¹ˆï¼Ÿ

---

### æ–¹æ³•2: å¯¹æ¯”æ—¶é—´æˆ³

TaskIdçš„æ ¼å¼æ˜¯ `task_{timestamp}_{random}`

**æ—§çš„é”™è¯¯taskId**:

```
task_1761796411352_hus1tzkaj
      â†‘
      æ—¶é—´æˆ³: 1761796411352
      è½¬æ¢: 2025-10-30 04:00:11 UTC
```

**æ–°çš„æ­£ç¡®taskId**:

```
task_1761797568494_qkjctfiwa
      â†‘
      æ—¶é—´æˆ³: 1761797568494
      è½¬æ¢: 2025-10-30 04:19:28 UTC
```

ä¸¤ä¸ªtaskIdç›¸å·®çº¦**19åˆ†é’Ÿ**ï¼

**è¿™è¯´æ˜å·¥ä½œæµ3æ­£åœ¨å¤„ç†ä¸€ä¸ª19åˆ†é’Ÿå‰çš„æ—§è¯·æ±‚ã€‚**

---

## ğŸ“Š è¯Šæ–­ç»“æœæŠ¥å‘Šæ¨¡æ¿

å®Œæˆä¸Šè¿°æ‰€æœ‰æ­¥éª¤åï¼Œè¯·æŒ‰ä»¥ä¸‹æ ¼å¼æä¾›ä¿¡æ¯ï¼š

```
=== å‰ç«¯æ—¥å¿— ===
âœ… Task created: task_???
ğŸ” Constructed statusUrl: https://...
ğŸ” Polling URL: https://...

=== Networkè¯·æ±‚ ===
Request URL: https://...

=== å·¥ä½œæµ3æ—¥å¿— ===
ğŸ¯ EXTRACTION RESULT:
  taskId: task_???
  Method: ???

=== å·¥ä½œæµ1åˆ›å»ºçš„taskId ===
task_???

=== å¯¹æ¯”ç»“æœ ===
- å‰ç«¯å’Œå·¥ä½œæµ1: ä¸€è‡´/ä¸ä¸€è‡´
- å‰ç«¯å’ŒNetwork: ä¸€è‡´/ä¸ä¸€è‡´
- Networkå’Œå·¥ä½œæµ3: ä¸€è‡´/ä¸ä¸€è‡´
```

---

## ğŸš€ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

åœ¨æ‰¾åˆ°æ ¹æœ¬åŸå› ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªä¸´æ—¶æ–¹æ¡ˆå¿«é€Ÿæµ‹è¯•ï¼š

### 1. ç¦ç”¨å‰ç«¯çš„2.5åˆ†é’Ÿå»¶è¿Ÿ

ä¿®æ”¹å‰ç«¯ä»£ç ï¼ˆå¿«é€Ÿæµ‹è¯•ç”¨ï¼‰ï¼š

```typescript
// ä¸´æ—¶æ”¹ä¸º10ç§’ï¼Œæ–¹ä¾¿æµ‹è¯•
const initialDelay = 10000; // ä» 150000 æ”¹ä¸º 10000
```

è¿™æ ·å¯ä»¥æ›´å¿«åœ°è§¦å‘è½®è¯¢ï¼Œä¾¿äºè§‚å¯Ÿæ—¥å¿—ã€‚

---

### 2. ä½¿ç”¨curlç›´æ¥æµ‹è¯•

è·å–ä¸€ä¸ªæ–°åˆ›å»ºçš„taskIdï¼Œç„¶åï¼š

```bash
# æ–¹æ³•1: æµ‹è¯•æå–é€»è¾‘
curl -v "https://n8n.wendealai.com/webhook/process-subject-task/task-status/task_NEW_TASKID_HERE"

# æ–¹æ³•2: æŸ¥çœ‹æ•°æ®åº“ä¸­çš„ä»»åŠ¡
# (åˆ›å»ºä¸´æ—¶å·¥ä½œæµï¼šManual Trigger â†’ Data Table Get All)
```

---

## âœ… ä¸‹ä¸€æ­¥

è¯·å®Œæˆä»¥ä¸Šæ‰€æœ‰è¯Šæ–­æ­¥éª¤ï¼Œå¹¶æä¾›ï¼š

1. **å‰ç«¯Consoleçš„å®Œæ•´æ—¥å¿—**ï¼ˆä»æäº¤åˆ°è½®è¯¢ï¼‰
2. **Networkä¸­çš„Request URL**
3. **å·¥ä½œæµ3çš„Extract Task IDæ—¥å¿—**
4. **å·¥ä½œæµ1åˆ›å»ºçš„taskId**ï¼ˆä»n8næ‰§è¡Œå†å²ï¼‰

æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œæˆ‘å°±èƒ½**ç²¾å‡†å®šä½é—®é¢˜å¹¶æä¾›ä¿®å¤æ–¹æ¡ˆ**ï¼ğŸ¯
