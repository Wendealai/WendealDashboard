# Rednote Img Generator 使用说明

## 概述

Rednote Img Generator 是 Social Media 模块中的一个工作流卡片，用于将小红书文案转换成图片HTML格式。

## 功能特性

- ✅ 输入小红书文案内容
- ✅ 通过 webhook 发送到 n8n 工作流处理
- ✅ 等待返回 HTML 代码
- ✅ 在输出框中预览生成的 HTML
- ✅ 提供新窗口打开功能
- ✅ 支持复制 HTML 代码到剪贴板

## 使用步骤

### 1. 访问工作流

1. 打开应用并导航到 `Social Media` 页面
2. 在工作流列表中找到 **Rednote Img Generator** 卡片
3. 点击卡片进入工作流页面

### 2. 输入文案

在左侧输入区域：

- 在 **文案内容** 文本框中输入小红书文案
- 最大支持 2000 字符
- 文本框右下角会显示字符计数

### 3. 生成图片

1. 确认文案内容无误后，点击 **生成图片** 按钮
2. 系统会显示生成进度条和状态提示
3. 等待 n8n 工作流处理完成

### 4. 查看结果

生成完成后，右侧输出区域会显示：

- **HTML 预览**：直接渲染的 HTML 内容
- **HTML 代码**：完整的 HTML 源代码

### 5. 使用生成的内容

两种方式使用生成的 HTML：

#### 方式一：新窗口打开

- 点击右上角的 **新窗口打开** 按钮
- HTML 内容将在新浏览器窗口中打开
- 可以在新窗口中进一步操作（如截图、打印等）

#### 方式二：复制 HTML

- 点击 **复制HTML** 按钮
- HTML 代码会自动复制到剪贴板
- 可以粘贴到其他编辑器或平台使用

### 6. 重置

如需重新开始：

- 点击右上角的 **重置** 按钮
- 清除所有输入和输出内容

## Webhook 配置

### n8n Webhook URL

```
https://n8n.wendealai.com/webhook/rednoteimggen
```

### 请求格式

```json
{
  "content": "小红书文案内容",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### 响应格式

```json
{
  "success": true,
  "html": "<html>...</html>",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "metadata": {
    "processingTime": 1200,
    "imageUrl": "https://..."
  }
}
```

## 技术细节

### 组件位置

- 组件文件：`src/pages/SocialMedia/components/RednoteImgGenerator.tsx`
- 样式文件：`src/pages/SocialMedia/components/RednoteImgGenerator.css`
- 类型定义：`src/pages/SocialMedia/types.ts`

### 工作流程

1. **用户输入** → 组件接收文案内容
2. **数据准备** → 构造 webhook 请求 payload
3. **发送请求** → POST 到 n8n webhook endpoint
4. **等待响应** → 显示进度条，等待 n8n 处理
5. **解析响应** → 提取返回的 HTML 代码
6. **渲染显示** → 在预览区域显示 HTML

### 错误处理

组件包含完善的错误处理：

- 网络请求失败
- Webhook 响应错误
- HTML 内容缺失
- 浏览器弹窗被阻止

所有错误都会在界面上显示友好的提示信息。

## 最佳实践

1. **文案长度**：建议控制在 1000 字符以内，以获得最佳生成效果
2. **内容格式**：使用清晰的段落结构，便于 AI 处理
3. **特殊字符**：避免使用过多特殊符号，可能影响渲染效果
4. **预览检查**：生成后先在预览区域检查效果，再决定是否使用

## 故障排查

### 生成失败

**问题**：点击生成按钮后报错

**解决方案**：

1. 检查网络连接是否正常
2. 确认 n8n webhook 服务是否运行
3. 查看浏览器控制台错误信息
4. 尝试减少文案长度后重试

### 无法打开新窗口

**问题**：点击"新窗口打开"没有反应

**解决方案**：

1. 检查浏览器是否阻止了弹窗
2. 在浏览器设置中允许网站弹窗
3. 使用"复制HTML"功能作为替代方案

### 预览显示异常

**问题**：HTML 预览区域显示不正常

**解决方案**：

1. 检查返回的 HTML 代码是否完整
2. 查看浏览器控制台是否有 CSS/JS 错误
3. 尝试在新窗口打开查看完整效果

## 更新日志

### Version 1.0.0 (2024-01-01)

- ✅ 初始版本发布
- ✅ 支持文案输入和 HTML 生成
- ✅ 集成 n8n webhook
- ✅ 实现预览和导出功能
- ✅ 添加错误处理和用户提示

## 相关链接

- [n8n 工作流配置](https://n8n.wendealai.com)
- [Social Media 模块文档](./SOCIAL_MEDIA.md)
- [Webhook 集成指南](./WEBHOOK_INTEGRATION.md)

## 技术支持

如遇到问题或有改进建议，请联系开发团队。
